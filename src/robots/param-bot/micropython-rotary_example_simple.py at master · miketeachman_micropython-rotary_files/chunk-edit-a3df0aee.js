System.register(["./chunk-vendor.js","./chunk-frameworks.js"],(function(e){"use strict";var t,s,n,o,c,i,r,m,a;return{setters:[function(e){t=e.o,s=e.a,n=e.r,o=e.f},function(e){c=e.c,i=e.e,r=e.u,m=e.g,a=e.h}],execute:function(){e("h",j);let l=[];function u(e){e.querySelector(".js-write-tab").click();const t=e.querySelector(".js-comment-field");t.focus(),o(t,"change")}function d(e){return e.querySelector(".js-comment-edit-form-deferred-include-fragment")}function j(e){const t=e.currentTarget.closest("form"),s=e.currentTarget.getAttribute("data-confirm-text");if(a(t)&&!confirm(s))return!1;for(const o of t.querySelectorAll("input, textarea")){const e=o;e.value=e.defaultValue,e.classList.contains("session-resumable-canceled")&&(e.classList.add("js-session-resumable"),e.classList.remove("session-resumable-canceled"))}const n=e.currentTarget.closest(".js-comment");return n&&n.classList.remove("is-comment-editing"),!0}function f(e){const t=e.querySelector("ol");if(t){t.innerHTML="";const e=l.map((e=>{const t=document.createElement("li");return t.textContent=e,t}));for(const s of e)t.appendChild(s)}e.hidden=!1}t(".js-comment-header-actions-deferred-include-fragment",{subscribe:e=>c(e,"loadstart",(()=>{var t;null===(t=d(e.closest(".js-comment")))||void 0===t||t.load()}),{capture:!1,once:!0})}),s("click",".js-comment-edit-button",(function(e){const t=e.currentTarget.closest(".js-comment");t.classList.add("is-comment-editing");const s=d(t);s?s.addEventListener("include-fragment-replaced",(()=>u(t)),{once:!0}):u(t);const n=e.currentTarget.closest(".js-dropdown-details");n&&n.removeAttribute("open")})),s("click",".js-comment-hide-button",(function(e){const t=e.currentTarget.closest(".js-comment").querySelector(".js-minimize-comment");t&&t.classList.remove("d-none");const s=e.currentTarget.closest(".js-dropdown-details");s&&s.removeAttribute("open")})),s("click",".js-comment-hide-minimize-form",(function(e){e.currentTarget.closest(".js-minimize-comment").classList.add("d-none")})),s("click",".js-comment-cancel-button",j),s("click",".js-cancel-issue-edit",(function(e){e.currentTarget.closest(".js-details-container").querySelector(".js-comment-form-error").hidden=!0})),n(".js-comment-delete, .js-comment .js-comment-update, .js-issue-update, .js-comment-minimize, .js-comment-unminimize",(function(e,t,s){const n=e.closest(".js-comment");n.classList.add("is-comment-loading");const o=n.getAttribute("data-body-version");o&&s.headers.set("X-Body-Version",o)})),n(".js-comment .js-comment-update",(async function(e,t){let s;const n=e.closest(".js-comment"),o=n.querySelector(".js-comment-update-error"),c=n.querySelector(".js-comment-body-error");o instanceof HTMLElement&&(o.hidden=!0),c instanceof HTMLElement&&(c.hidden=!0),l=[];try{s=await t.json()}catch(d){if(422!==d.response.status)throw d;{const e=JSON.parse(d.response.text);if(e.errors)return void(o instanceof HTMLElement&&(o.textContent="There was an error posting your comment: "+e.errors.join(", "),o.hidden=!1))}}if(!s)return;const r=s.json;r.errors&&r.errors.length>0&&(l=r.errors,f(c));const m=n.querySelector(".js-comment-body");m&&r.body&&(m.innerHTML=r.body),n.setAttribute("data-body-version",r.newBodyVersion);const a=n.querySelector(".js-body-version");a instanceof HTMLInputElement&&(a.value=r.newBodyVersion);for(const i of n.querySelectorAll("input, textarea")){const e=i;e.defaultValue=e.value}n.classList.remove("is-comment-stale","is-comment-editing");const u=n.querySelector(".js-comment-edit-history");if(u){const e=await i(document,r.editUrl);u.innerHTML="",u.append(e)}})),t(".js-comment-body-error",{add:e=>{l&&l.length>0&&f(e)}}),n(".js-comment .js-comment-delete, .js-comment .js-comment-update, .js-comment-minimize, .js-comment-unminimize",(async function(e,t){const s=e.closest(".js-comment");try{await t.text()}catch(n){if(422!==n.response.status)throw n;{let e;try{e=JSON.parse(n.response.text)}catch(o){}e&&e.stale&&s.classList.add("is-comment-stale")}}s.classList.remove("is-comment-loading")})),n(".js-discussion-comment-unminimize, .js-discussion-comment-minimize",(async function(e,t){const s=e.closest(".js-discussion-comment"),n=s.querySelector(".js-discussion-comment-error");n&&(n.hidden=!0);try{const e=await t.html();s.replaceWith(e.html)}catch(o){if(!(o.response.status>=400&&o.response.status<500))throw o;if(o.response.html){const e=o.response.html.querySelector(".js-discussion-comment").getAttribute("data-error");n instanceof HTMLElement&&(n.textContent=e,n.hidden=!1)}}})),n(".js-comment-delete",(async function(e,t){await t.json();let s=e.closest(".js-comment-delete-container");s||(s=e.closest(".js-comment-container")||e.closest(".js-line-comments"),s&&1!==s.querySelectorAll(".js-comment").length&&(s=e.closest(".js-comment"))),s.remove()})),n(".js-issue-update",(async function(e,t){var s,n,o;const c=e.closest(".js-details-container"),i=c.querySelector(".js-comment-form-error");let r;try{r=await t.json()}catch(a){i.textContent=(null===(o=null===(n=null===(s=a.response)||void 0===s?void 0:s.json)||void 0===n?void 0:n.errors)||void 0===o?void 0:o[0])||"Something went wrong. Please try again.",i.hidden=!1}if(!r)return;c.classList.remove("open"),i.hidden=!0;const m=r.json;if(null!=m.issue_title){c.querySelector(".js-issue-title").textContent=m.issue_title;const e=c.closest(".js-issues-results");if(e){if(e.querySelector(".js-merge-pr.is-merging")){const t=e.querySelector(".js-merge-pull-request textarea");t instanceof HTMLTextAreaElement&&t.value===t.defaultValue&&(t.value=t.defaultValue=m.issue_title)}else if(e.querySelector(".js-merge-pr.is-squashing")){const t=e.querySelector(".js-merge-pull-request .js-merge-title");t instanceof HTMLInputElement&&t.value===t.defaultValue&&(t.value=t.defaultValue=m.default_squash_commit_title)}const t=e.querySelector("button[value=merge]");t&&t.setAttribute("data-input-message-value",m.issue_title);const s=e.querySelector("button[value=squash]");s&&s.setAttribute("data-input-title-value",m.default_squash_commit_title)}}document.title=m.page_title;for(const l of e.elements)(l instanceof HTMLInputElement||l instanceof HTMLTextAreaElement)&&(l.defaultValue=l.value)})),n(".js-comment-minimize",(async function(e,t){await t.json();const s=e.closest(".js-comment"),n=s.querySelector(".js-minimize-comment");if(n&&n.classList.contains("js-update-minimized-content")){const t=e.querySelector("input[type=submit], button[type=submit]");t&&t.classList.add("disabled");const n=s.closest(".js-comment-container");n&&await r(n)}else{n&&n.classList.add("d-none");const t=e.closest(".unminimized-comment");t.classList.add("d-none"),t.classList.remove("js-comment");const s=e.closest(".js-minimizable-comment-group").querySelector(".minimized-comment");s&&s.classList.remove("d-none"),s&&s.classList.add("js-comment")}})),n(".js-comment-unminimize",(async function(e,t){await t.json();const s=e.closest(".js-minimizable-comment-group"),n=s.querySelector(".unminimized-comment"),o=s.querySelector(".minimized-comment");if(n)n.classList.remove("d-none"),n.classList.add("js-comment"),o&&o.classList.add("d-none"),o&&o.classList.remove("js-comment");else{if(o){const e=o.querySelector(".timeline-comment-actions");e&&e.classList.add("d-none"),o.classList.remove("js-comment")}const e=s.closest(".js-comment-container");await r(e)}})),s("details-menu-select",".js-comment-edit-history-menu",(e=>{const t=e.detail.relatedTarget.getAttribute("data-edit-history-url");if(!t)return;e.preventDefault();const s=i(document,t);m({content:s,dialogClass:"Box-overlay--wide"})}),{capture:!0})}}}));
//# sourceMappingURL=chunk-edit-ffb4035f.js.map
